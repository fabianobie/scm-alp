<?xml version="1.0" encoding="ISO-8859-1"?>
<project name="hibernate-tools" basedir="." default="inicializar">
	<property file="asi-build.properties"/>
	<property name="var.is.gerar.entidade.do.hbm.${is.gerar.entidade.do.hbm}" value="true"/>
	<property name="var.is.gerar.entidade.do.banco.${is.gerar.entidade.do.banco}" value="true"/>
	<property name="var.is.gerar.dao.do.hbm.${is.gerar.dao.do.hbm}" value="true"/>
	<property name="var.is.gerar.dao.do.banco.${is.gerar.dao.do.banco}" value="true"/>
	<property name="var.is.gerar.hbm.da.entidade.${is.gerar.hbm.da.entidade}" value="true"/>

	<path id="classpath">
		<fileset dir="${classpath.lib}">
			<include name="**/*jar"/>
		</fileset>
		<fileset dir="${classpath.lib.externa}">
			<include name="**/*jar"/>
		</fileset>
		<path location="${classpath.classes}" />
	</path>
	
	<taskdef 
		name="hibernatetool" 
	    classname="org.hibernate.tool.ant.HibernateToolTask" 
	    classpathref="classpath"/>

	<target name="inicializar">
		<antcall target="delete-pasta-destino"/>
		<antcall target="gerar-hbm-da-entidade"/>
		<antcall target="gerar-entidade-do-hbm"/>
		<antcall target="gerar-entidade-do-banco"/>
		<antcall target="gerar-dao-do-hbm"/>
		<antcall target="gerar-dao-do-banco"/>
	</target>
	
	<target name="delete-pasta-destino">
		<delete includeemptydirs="true">
			<fileset dir="${path.destino.root}" includes="**/*"/>
		</delete>
	</target>
	
	<target name="gerar-hbm-da-entidade" if="var.is.gerar.hbm.da.entidade.true"> 
		<hibernatetool destdir="${path.destino.root}" templatepath="${jpa2hbm.templateprefix}"> 
			<classpath refid="classpath"/>
			<property key="hibernatetool.util.toolclass" value="${jpa2hbm.util}"/>
			
			<jpaconfiguration persistenceunit="${jpa2hbm.nome.pu}" />
			<hbm2hbmxml />
		</hibernatetool> 
	</target> 
		
	<target name="gerar-entidade-do-hbm" if="var.is.gerar.entidade.do.hbm.true"> 
		<hibernatetool destdir="${path.destino.root}"> 
			<classpath refid="classpath"/>
			<property key="hibernatetool.util.toolclass" value="${hbm2jpa.util}"/>
			
			<configuration> 
				<fileset dir="${hbm2jpa.path.source.hbm}"> 
					<include name="**/*.hbm.xml"/> 
				</fileset> 
			</configuration>

			<hbmtemplate 
				templateprefix="${hbm2jpa.templateprefix}"
				template="${hbm2jpa.template}"
				filepattern="{package-name}/{class-name}.java"
				exporterclass="${hbm2jpa.exporterclass}">
				
				<property key="jdk5" 				value="true" />
				<property key="ejb3" 				value="true" />
			</hbmtemplate>
		</hibernatetool> 
	</target> 
	
	<target name="gerar-entidade-do-banco" if="var.is.gerar.entidade.do.banco.true">
		<hibernatetool destdir="${path.destino.root}">
			<classpath refid="classpath"/>
			<property key="hibernatetool.util.toolclass" value="${entidade.util}"/>
			
			<jdbcconfiguration 
				configurationfile="${path.arquivo.hibernate}" 
				packagename="${entidade.pacote}"
				revengfile="${path.arquivo.revengfile}"
				detectmanytomany="true"
				reversestrategy="${classe.reversestrategy}"
			/>
			
			<hbmtemplate 
				templateprefix="${entidade.templateprefix}"
				template="${entidade.template}"
				filepattern="{package-name}/{class-name}.java"
				exporterclass="${entidade.exporterclass}">
				
				<property key="jdk5" 				value="true" />
				<property key="ejb3" 				value="true" />
			</hbmtemplate>
		</hibernatetool>
	</target>
	
	<target name="gerar-dao-do-hbm" if="var.is.gerar.dao.do.hbm.true">
		<hibernatetool destdir="${path.destino.root}">
			<classpath refid="classpath"/>
			<property key="hibernatetool.util.toolclass" value="${dao.util}"/>
			
			<configuration> 
				<fileset dir="${dao.path.source.hbm}"> 
					<include name="**/*.hbm.xml"/> 
				</fileset> 
			</configuration>
			
			<hbmtemplate 
				templateprefix="${dao.templateprefix}"
				template="${dao.template}"
				filepattern="${dao.pacote}/{class-name}${dao.var_sufixo_classe}.java"
				exporterclass="${dao.exporterclass}">
				
				<property key="jdk5" 						value="true" />
				<property key="ejb3" 						value="true" />
				<property key="var_superclasse" 			value="${dao.var_superclasse}"/>
				<property key="var_sufixo_classe" 			value="${dao.var_sufixo_classe}"/>
				<property key="var_pacote_entidade" 		value="${dao.var_pacote_entidade}"/>
				<property key="var_pacote_dao"				value="${dao.pacote}"/>
			</hbmtemplate>
		</hibernatetool>
	</target>

	<target name="gerar-dao-do-banco" if="var.is.gerar.dao.do.banco.true">
		<hibernatetool destdir="${path.destino.root}">
			<classpath refid="classpath"/>
			<property key="hibernatetool.util.toolclass" value="${dao.util}"/>
			
			<jdbcconfiguration 
				configurationfile="${path.arquivo.hibernate}" 
				packagename="${dao.pacote}"
				revengfile="${path.arquivo.revengfile}"
				detectmanytomany="true"
				reversestrategy="${classe.reversestrategy}"
			/>
			
			<hbmtemplate 
				templateprefix="${dao.templateprefix}"
				template="${dao.template}"
				filepattern="${dao.pacote}/{class-name}${dao.var_sufixo_classe}.java"
				exporterclass="${dao.exporterclass}">
				
				<property key="jdk5" 						value="true" />
				<property key="ejb3" 						value="true" />
				<property key="var_superclasse" 			value="${dao.var_superclasse}"/>
				<property key="var_sufixo_classe" 			value="${dao.var_sufixo_classe}"/>
				<property key="var_pacote_entidade" 		value="${dao.var_pacote_entidade}"/>
				<property key="var_pacote_dao"				value="${dao.pacote}"/>
			</hbmtemplate>
		</hibernatetool>
	</target>

</project>