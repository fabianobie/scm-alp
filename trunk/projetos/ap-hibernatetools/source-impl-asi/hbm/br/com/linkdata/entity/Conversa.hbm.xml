<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated 23/12/2009 11:50:13 by Hibernate Tools 3.2.5.Beta -->
<hibernate-mapping>
	<meta attribute="class-code">
	/**
	 * Adiciona uma mensagem.
	 * @param mensagem Mensagem
	 */
	public void addMensagem(Mensagem mensagem){
		if (mensagens == null) {
			mensagens = new ArrayList&lt;Mensagem&gt;();
		}
		setDataUltimaMensagem(mensagem.getData());
		mensagens.add(mensagem);
	}
	
	/**
	 * Adiciona um envolvido.
	 * @param envolvido Envolvido
	 */
	public void addEnvolvidos(Envolvido envolvido){
		if (envolvidos == null) {
			envolvidos = new HashSet&lt;Envolvido&gt;();
		}
		envolvidos.add(envolvido);
	}
	
	</meta>
    <class name="br.com.linkdata.entity.Conversa" table="CONVERSA">
        <id name="id" type="java.lang.Long" access="field">
            <column name="ID_CONVERSA" precision="12" scale="0" />
            <generator class="sequence">
                <param name="max_lo">49</param>
                <param name="sequence">SQ_CONVERSA</param>
            </generator>
        </id>
        <property name="assunto" type="java.lang.String" access="field">
            <column name="ASSUNTO" not-null="true" />
        </property>
        <property name="dataUltimaMensagem" type="timestamp" access="field">
            <column name="DT_ULTIMA_MENSAGEM" not-null="true" />
        </property>
        <set name="envolvidos" inverse="true" lazy="true" table="ENVOLVIDO_CONVERSA" fetch="select">
            <key>
                <column name="ID_CONVERSA" />
            </key>
            <one-to-many class="br.com.linkdata.entity.Envolvido" />
        </set>
        <list name="mensagens" inverse="false" table="MENSAGEM" lazy="true" cascade="persist,merge,delete" fetch="select">
            <key>
                <column name="ID_CONVERSA" />
            </key>
            <index column="NR_ORDEM" />
            <one-to-many class="br.com.linkdata.entity.Mensagem" />
        </list>
        <many-to-one name="prioridade" class="br.com.linkdata.entity.Prioridade" access="field" fetch="join">
            <column name="ID_PRIORIDADE" />
        </many-to-one>
        <property name="processInstanceId" type="java.lang.Long" access="field">
            <column name="ID_PROCESS_INSTANCE" precision="12" scale="0" />
        </property>
        <property name="taskId" type="java.lang.Long" access="field">
            <column name="ID_TASK" precision="12" scale="0" />
        </property>
        <property name="taskIdDestino" type="java.lang.Long" access="field">
            <column name="ID_TASK_DESTINO" precision="12" scale="0" />
        </property>
        <many-to-one name="tipoConversa" class="br.com.linkdata.entity.TipoConversa" access="field" fetch="join">
            <column name="ID_TIPO_CONVERSA" />
        </many-to-one>
    </class>
</hibernate-mapping>
